<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout/base}">

<head>
    <title layout:fragment="title">Admin Panel</title>
    <th:block layout:fragment="head">
        <!-- Chart.js für Statistiken -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <!-- DataTables für Tabellen -->
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/dataTables.tailwindcss.min.css">
        <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.6/js/dataTables.tailwindcss.min.js"></script>
    </th:block>
</head>

<body>
    <div layout:fragment="content">
        <!-- Admin Access Check -->
        <div sec:authorize="!hasRole('ROLE_ADMIN')" class="text-center py-16">
            <div class="max-w-md mx-auto bg-red-50 dark:bg-red-900/20 rounded-lg p-8">
                <svg class="mx-auto h-16 w-16 text-red-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"></path>
                </svg>
                <h2 class="text-xl font-semibold text-red-800 dark:text-red-300 mb-2">Zugriff verweigert</h2>
                <p class="text-red-600 dark:text-red-400">Sie haben keine Berechtigung, auf das Admin Panel zuzugreifen.</p>
                <a href="/dashboard" class="inline-block mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                    Zurück zum Dashboard
                </a>
            </div>
        </div>

        <!-- Admin Panel Content -->
        <div sec:authorize="hasRole('ROLE_ADMIN')" x-data="adminPanel()">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Admin Panel</h1>
                <p class="mt-2 text-gray-600 dark:text-gray-400">Verwaltung von Benutzern, Fragen und Systemeinstellungen</p>
            </div>

            <!-- Navigation Tabs -->
            <div class="border-b border-gray-200 dark:border-gray-700 mb-8">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <button @click="activeTab = 'overview'" 
                            :class="activeTab === 'overview' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                        Übersicht
                    </button>
                    <button @click="activeTab = 'users'" 
                            :class="activeTab === 'users' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                        Benutzerverwaltung
                    </button>
                    <button @click="activeTab = 'questions'" 
                            :class="activeTab === 'questions' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                        Fragenverwaltung
                    </button>
                    <button @click="activeTab = 'statistics'" 
                            :class="activeTab === 'statistics' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                        Statistiken
                    </button>
                    <button @click="activeTab = 'settings'" 
                            :class="activeTab === 'settings' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                        Systemeinstellungen
                    </button>
                </nav>
            </div>

            <!-- Overview Tab -->
            <div x-show="activeTab === 'overview'" class="space-y-6">
                <!-- Quick Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Total Users -->
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <svg class="h-6 w-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                                    </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Gesamte Benutzer</dt>
                                        <dd class="text-lg font-medium text-gray-900 dark:text-white" x-text="stats.totalUsers">0</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Total Questions -->
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <svg class="h-6 w-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Gesamte Fragen</dt>
                                        <dd class="text-lg font-medium text-gray-900 dark:text-white" x-text="stats.totalQuestions">0</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Active Sessions -->
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Aktive Sessions</dt>
                                        <dd class="text-lg font-medium text-gray-900 dark:text-white" x-text="stats.activeSessions">0</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Health -->
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <svg class="h-6 w-6 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Systemstatus</dt>
                                        <dd class="text-lg font-medium text-green-600 dark:text-green-400">Online</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="bg-white dark:bg-gray-800 shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4">Letzte Aktivitäten</h3>
                        <div class="flow-root">
                            <ul class="-mb-8">
                                <li class="relative pb-8">
                                    <div class="flex space-x-3">
                                        <div class="flex-shrink-0">
                                            <span class="h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center">
                                                <svg class="h-4 w-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <div>
                                                <div class="text-sm text-gray-500 dark:text-gray-400">
                                                    <span class="font-medium text-gray-900 dark:text-white">Neuer Benutzer registriert</span>
                                                    <time datetime="2024-01-15T09:30:00">vor 2 Stunden</time>
                                                </div>
                                                <p class="mt-0.5 text-sm text-gray-500 dark:text-gray-400">Max Mustermann hat sich registriert</p>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li class="relative pb-8">
                                    <div class="flex space-x-3">
                                        <div class="flex-shrink-0">
                                            <span class="h-8 w-8 rounded-full bg-green-500 flex items-center justify-center">
                                                <svg class="h-4 w-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <div>
                                                <div class="text-sm text-gray-500 dark:text-gray-400">
                                                    <span class="font-medium text-gray-900 dark:text-white">Neue Frage erstellt</span>
                                                    <time datetime="2024-01-15T08:15:00">vor 3 Stunden</time>
                                                </div>
                                                <p class="mt-0.5 text-sm text-gray-500 dark:text-gray-400">5 neue Fragen zum Thema "Java Grundlagen"</p>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Management Tab -->
            <div x-show="activeTab === 'users'" class="space-y-6">
                <div class="bg-white dark:bg-gray-800 shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white">Benutzerverwaltung</h3>
                            <button class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                                Neuer Benutzer
                            </button>
                        </div>

                        <!-- Search and Filter -->
                        <div class="mb-4 flex flex-col sm:flex-row gap-4">
                            <div class="flex-1">
                                <label for="user-search" class="sr-only">Benutzer suchen</label>
                                <input type="text" id="user-search" class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white" placeholder="Benutzer suchen...">
                            </div>
                            <div>
                                <select class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                    <option>Alle Rollen</option>
                                    <option>Admin</option>
                                    <option>Lehrer</option>
                                    <option>Schüler</option>
                                </select>
                            </div>
                        </div>

                        <!-- Users Table -->
                        <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
                            <table id="usersTable" class="min-w-full divide-y divide-gray-300 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Benutzer</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">E-Mail</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Rolle</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Registriert</th>
                                        <th class="relative px-6 py-3"><span class="sr-only">Aktionen</span></th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Benutzer werden hier dynamisch geladen -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Question Management Tab -->
            <div x-show="activeTab === 'questions'" class="space-y-6">
                <div class="bg-white dark:bg-gray-800 shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white">Fragenverwaltung</h3>
                            <div class="flex gap-2">
                                <button class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                                    <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                                    </svg>
                                    Import
                                </button>
                                <button class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                                    <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                    </svg>
                                    Neue Frage
                                </button>
                            </div>
                        </div>

                        <!-- Question Filters -->
                        <div class="mb-4 grid grid-cols-1 md:grid-cols-4 gap-4">
                            <input type="text" placeholder="Frage suchen..." class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                            <select class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                <option>Alle Themen</option>
                                <option>Java Grundlagen</option>
                                <option>Datenbanken</option>
                                <option>Netzwerke</option>
                            </select>
                            <select class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                <option>Alle Schwierigkeitsgrade</option>
                                <option>Einfach (1)</option>
                                <option>Mittel (2-3)</option>
                                <option>Schwer (4-5)</option>
                            </select>
                            <select class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                <option>Alle Typen</option>
                                <option>Multiple Choice</option>
                                <option>Single Choice</option>
                                <option>Wahr/Falsch</option>
                                <option>Text Input</option>
                            </select>
                        </div>

                        <!-- Questions Table -->
                        <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
                            <table id="questionsTable" class="min-w-full divide-y divide-gray-300 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Frage</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Thema</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Typ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Schwierigkeit</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Status</th>
                                        <th class="relative px-6 py-3"><span class="sr-only">Aktionen</span></th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Fragen werden hier dynamisch geladen -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics Tab -->
            <div x-show="activeTab === 'statistics'" class="space-y-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- User Growth Chart -->
                    <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Benutzerwachstum</h3>
                        <canvas id="userGrowthChart" width="400" height="200"></canvas>
                    </div>

                    <!-- Question Distribution -->
                    <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Fragenverteilung nach Themen</h3>
                        <canvas id="questionDistributionChart" width="400" height="200"></canvas>
                    </div>

                    <!-- Activity Heatmap -->
                    <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6 lg:col-span-2">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Aktivitäts-Heatmap</h3>
                        <div class="grid grid-cols-7 gap-1">
                            <!-- Heatmap wird hier generiert -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div x-show="activeTab === 'settings'" class="space-y-6">
                <div class="bg-white dark:bg-gray-800 shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white mb-6">Systemeinstellungen</h3>
                        
                        <form class="space-y-6">
                            <!-- General Settings -->
                            <div class="border-b border-gray-200 dark:border-gray-700 pb-6">
                                <h4 class="text-base font-medium text-gray-900 dark:text-white mb-4">Allgemeine Einstellungen</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Anwendungsname</label>
                                        <input type="text" value="Fachinformatiker Lernapp" class="mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Wartungsmodus</label>
                                        <div class="mt-1">
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                                <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Wartungsmodus aktivieren</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- User Settings -->
                            <div class="border-b border-gray-200 dark:border-gray-700 pb-6">
                                <h4 class="text-base font-medium text-gray-900 dark:text-white mb-4">Benutzereinstellungen</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Registrierung erlauben</label>
                                        <div class="mt-1">
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" checked class="form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                                <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Neue Registrierungen zulassen</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">E-Mail-Verifizierung erforderlich</label>
                                        <div class="mt-1">
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                                <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">E-Mail-Verifizierung erforderlich</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Learning Settings -->
                            <div class="border-b border-gray-200 dark:border-gray-700 pb-6">
                                <h4 class="text-base font-medium text-gray-900 dark:text-white mb-4">Lerneinstellungen</h4>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Standard-Fragenanzahl</label>
                                        <input type="number" value="10" min="1" max="50" class="mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Zeitlimit (Minuten)</label>
                                        <input type="number" value="30" min="1" max="180" class="mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Punkte pro Frage</label>
                                        <input type="number" value="10" min="1" max="100" class="mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white">
                                    </div>
                                </div>
                            </div>

                            <!-- Save Button -->
                            <div class="flex justify-end">
                                <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                    <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    Einstellungen speichern
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <th:block layout:fragment="scripts">
        <script>
            function adminPanel() {
                return {
                    activeTab: 'overview',
                    stats: {
                        totalUsers: 125,
                        totalQuestions: 542,
                        activeSessions: 23,
                        systemHealth: 'healthy'
                    },
                    
                    init() {
                        this.loadStats();
                        this.initCharts();
                        this.initDataTables();
                    },
                    
                    loadStats() {
                        // Lade Statistiken via API
                        // fetch('/api/admin/stats')...
                    },
                    
                    initCharts() {
                        // User Growth Chart
                        const ctx1 = document.getElementById('userGrowthChart');
                        new Chart(ctx1, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun'],
                                datasets: [{
                                    label: 'Neue Benutzer',
                                    data: [12, 19, 15, 25, 22, 30],
                                    borderColor: 'rgb(59, 130, 246)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    tension: 0.1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Question Distribution Chart
                        const ctx2 = document.getElementById('questionDistributionChart');
                        new Chart(ctx2, {
                            type: 'doughnut',
                            data: {
                                labels: ['Java', 'Datenbanken', 'Netzwerke', 'Sicherheit', 'Andere'],
                                datasets: [{
                                    data: [30, 25, 20, 15, 10],
                                    backgroundColor: [
                                        'rgb(59, 130, 246)',
                                        'rgb(16, 185, 129)',
                                        'rgb(245, 158, 11)',
                                        'rgb(239, 68, 68)',
                                        'rgb(156, 163, 175)'
                                    ]
                                }]
                            },
                            options: {
                                responsive: true
                            }
                        });
                    },
                    
                    initDataTables() {
                        // Initialize DataTables when tables are visible
                        this.$watch('activeTab', (newTab) => {
                            if (newTab === 'users') {
                                setTimeout(() => {
                                    if ($.fn.dataTable.isDataTable('#usersTable')) {
                                        $('#usersTable').DataTable().destroy();
                                    }
                                    $('#usersTable').DataTable({
                                        responsive: true,
                                        pageLength: 10,
                                        language: {
                                            url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/de-DE.json'
                                        }
                                    });
                                }, 100);
                            } else if (newTab === 'questions') {
                                setTimeout(() => {
                                    if ($.fn.dataTable.isDataTable('#questionsTable')) {
                                        $('#questionsTable').DataTable().destroy();
                                    }
                                    $('#questionsTable').DataTable({
                                        responsive: true,
                                        pageLength: 10,
                                        language: {
                                            url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/de-DE.json'
                                        }
                                    });
                                }, 100);
                            }
                        });
                    }
                }
            }
        </script>
    </th:block>
</body>
</html>